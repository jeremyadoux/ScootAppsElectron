<div ng-controller="createTicketCtrl as ctc">
    <div ng-show="ctc.step == 1">
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-info" role="alert">
                    <p class="lead">Vous pouvez sélectionner 1 ou plusieurs écrans pour continuer.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-12">
                        <button ng-show="ctc.oneClickedImage()" ng-click="ctc.saveForm()" type="button"
                                class="btn btn-info">Continuer
                        </button>
                        <button ng-show="ctc.ready" class="btn btn-warning" type="button"
                                aria-label="Go to final" ng-click="ctc.reloadScreen()">Recharger les images
                        </button>
                    </div>
                </div>
                <div class="row" ng-if="$index%3==0" ng-repeat="source in ctc.sources">
                    <div class="col-md-4" ng-repeat="i in [0,1,2]">
                        <p ng-class="{'bg-primary': ctc.sources[$parent.$index+i].clicked}" style="padding: 10px;">
                            <img ng-src="{{ctc.sources[$parent.$index+i].urlTH}}"
                                 ng-click="ctc.clickedImage(ctc.sources[$parent.$index+i])"
                                 ng-dblclick="ctc.doubleClickedImage(ctc.sources[$parent.$index+i])"
                                 class="img-thumbnail"
                                 style="max-height: 250px;">
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <button ng-show="ctc.oneClickedImage()" ng-click="ctc.saveForm()" type="button"
                                class="btn btn-info">Continuer
                        </button>
                        <button ng-show="ctc.ready" class="btn btn-warning" type="button"
                                aria-label="Go to final" ng-click="ctc.reloadScreen()">Recharger les images
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ng-show="ctc.step == 2">
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-info" role="alert">
                    <p class="lead">Vous pouvez modifier les écrans sélectionnés.</p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12 toolbars-scout">
                <form class="form-inline">
                    <div class="form-group" ng-show="ctc.objectMode != 'pointer'">
                        <label for="inputColor">Couleur</label>
                        <input id="inputColor" ng-model="ctc.colorSelected" type="color">
                    </div>
                    <div class="form-group" ng-show="ctc.objectMode == 'pencil'">
                        <label for="inputLineWidth">Taille de la ligne</label>
                        <input id="inputLineWidth" ng-model="ctc.drawingPencil.lineWidth" type="text">
                    </div>
                    <div class="form-group" ng-show="ctc.objectMode == 'square'">
                        <label for="inputRectOpacity">Opacité</label>
                        <input id="inputRectOpacity" ng-model="ctc.rect.opacity" type="text">
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-1">
                <div class="row">
                    <div class="col-md-12">
                        <button class="btn btn-default" type="button" aria-label="Pointeur"
                                ng-click="ctc.changeDrawingMode('pointer')" ng-class="{'active': ctc.drawingMode == 'pointer'}">
                            <span class="glyphicon glyphicon-move" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-12">
                        <button class="btn btn-default" type="button" aria-label="Crayon"
                                ng-click="ctc.changeDrawingMode('pencil')" ng-class="{'active': ctc.drawingMode == 'pencil'}">
                            <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-12">
                        <button class="btn btn-default" type="button" aria-label="Ajouter une flèche"
                                ng-click="ctc.changeDrawingMode('arrow')" ng-class="{'active': ctc.drawingMode == 'arrow'}">
                            <span class="glyphicon glyphicon-arrow-right" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-12">
                        <button class="btn btn-default" type="button" aria-label="Carré"
                                ng-click="ctc.changeDrawingMode('square')" ng-class="{'active': ctc.drawingMode == 'square'}">
                            <span class="glyphicon glyphicon-stop" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-12">
                        <button class="btn btn-default" type="button" aria-label="Ajouter du texte"
                                ng-click="ctc.changeDrawingMode('text')" ng-class="{'active': ctc.drawingMode == 'text'}">
                            <span class="glyphicon glyphicon-text-color" aria-hidden="true"></span>
                        </button>
                    </div>
                    <div class="col-md-12">
                        <button class="btn btn-danger" type="button" aria-label="Effacer la sélection"
                                ng-click="ctc.removeSelectedFrabic()">
                            <span class="glyphicon glyphicon-trash" aria-hidden="true"></span>
                        </button>
                    </div>
                </div>
            </div>
            <div class="col-md-11">
                <div class="row">
                    <div class="col-md-12">
                        <ul class="pager">
                            <li>
                                <button ng-class="ctc.currentScreen > 0 ? 'btn-info' : 'btn-default disabled'" type="button"
                                        class="btn" ng-click="ctc.previousScreen()">Précédent
                                </button>
                            </li>
                            <li>Ecran {{ctc.currentScreen+1}} / {{ctc.selectedSources.length}}</li>
                            <li>
                                <button
                                    ng-class="ctc.currentScreen < (ctc.selectedSources.length -1) ? 'btn-info' : 'btn-default disabled'"
                                    type="button" class="btn" ng-click="ctc.nextScreen()">Suivant
                                </button>
                            </li>
                            <li>
                                <button class="btn btn-info" type="button" aria-label="Go to ticket"
                                        ng-click="ctc.goToCreateTicket()">Créer le ticket
                                </button>
                            </li>
                            <li>
                                <a href
                                        ng-click="ctc.step = ctc.step - 1">Revenir à l'étape précédente
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-12">
                        <canvas id="canvas">
                            Your browser does not support the canvas element.
                        </canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div ng-show="ctc.step == 3">
        <div class="row">
            <div class="col-md-12">
                <div class="alert alert-info" role="alert">
                    <p class="lead">Remplissez le formulaire de création de ticket.</p>
                </div>
            </div>
        </div>

        <div class="row" ng-show="ctc.messageToUSer != ''">
            <div class="col-md-12">
                <div class="alert alert-success" role="alert">
                    <p class="lead" ng-bind-html="ctc.messageToUSer"></p>
                </div>
            </div>
        </div>

        <div class="row" ng-show="ctc.errorMessage != ''">
            <div class="col-md-12">
                <div class="alert alert-danger" role="alert">
                    <p class="lead" ng-bind-html="ctc.errorMessage"></p>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-8">
                <form class="form-horizontal">
                    <div class="form-group">
                        <label for="inputMail" class="col-sm-2 control-label">Votre adresse mail</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" ng-model="ctc.createTicket.email" id="inputMail"
                                   placeholder="Votre email" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inputSubject" class="col-sm-2 control-label">Sujet</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" ng-model="ctc.createTicket.title" id="inputSubject"
                                   placeholder="Sujet" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="inputDescription" class="col-sm-2 control-label">Description</label>
                        <div class="col-sm-10">
                            <textarea id="inputDescription" ng-model="ctc.createTicket.description" class="form-control"
                                      rows="3" required></textarea>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <button type="button" class="btn btn-success" ng-click="ctc.saveTicketFull()">Créer le ticket</button>
                <a href
                   ng-click="ctc.step = ctc.step - 1">Revenir à l'étape précédente
                </a>
            </div>
        </div>
    </div>
</div>
